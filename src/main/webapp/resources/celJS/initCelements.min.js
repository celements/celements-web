!function(e,n){"use strict";if(void 0===e.console&&(e.console={}),void 0===e.console.error&&(e.console.error=Prototype.emptyFunction),void 0===e.console.warn&&(e.console.warn=e.console.error),void 0===e.console.info&&(e.console.info=e.console.warn),void 0===e.console.log&&(e.console.log=e.console.info),void 0===e.console.debug&&(e.console.debug=e.console.log),void 0===e.CELEMENTS&&(e.CELEMENTS={}),void 0===e.CELEMENTS.mixins&&(e.CELEMENTS.mixins={}),void 0===e.CELEMENTS.mixins.Event&&(e.CELEMENTS.mixins.Event=Class.create({memo:void 0,stopped:void 0,eventName:void 0,initialize:function(e,n){this.memo=n,this.eventName=e,this.stopped=!1},stop:function(){this.stopped=!0},findElement:function(){}})),void 0===e.CELEMENTS.mixins.Observable&&(e.CELEMENTS.mixins.Observable={_celEventHash:null,_getCelEventHash:function(e){const n=this;return n._celEventHash||(n._celEventHash=new Hash),e?(n._celEventHash.get(e)||n._celEventHash.set(e,new Array),n._celEventHash.get(e)):n._celEventHash},celObserve:function(e,n){if(console.debug("cel celObserve: ",this._celEventHash,e,n),!e)throw"undefined eventKey in observe call ";this._getCelEventHash(e).push(n)},celStopObserving:function(e,n){if(console.debug("cel celStopObserving: ",this._celEventHash,e,n),!e)throw"undefined eventKey in celStopObserving call ";this._getCelEventHash().set(e,this._getCelEventHash(e).without(n))},celFire:function(e,n){if(console.debug("cel celFire: ",this._celEventHash,e,n),!e)throw"undefined eventKey in celObserve call ";const t=new CELEMENTS.mixins.Event(e,n);return this._getCelEventHash(e).each((function(n){try{n(t)}catch(t){console.error("listener in celFire failed for event ",e,n,t)}})),t}}),e.celOnBeforeLoadListenerArray=[],e.celAddOnBeforeLoadListener=function(e){celOnBeforeLoadListenerArray.push(e)},e.celOnFinishHeaderListenerArray=[],e.celAddOnFinishHeaderListener=function(n){e.celOnFinishHeaderListenerArray.push(n)},e.celFinishHeaderHandler=function(){$A(e.celOnFinishHeaderListenerArray).each((function(e){try{e()}catch(e){console.error("Failed to execute celOnFinishHeader listener. ",e)}}))},void 0===e.getCelDomain&&(e.getCelDomain=function(){return e.location.host.replace(/^www\./,"")}),void 0===e.CELEMENTS.LoadingIndicator&&(e.CELEMENTS.LoadingIndicator=Class.create({_loadingImg:void 0,initialize:function(){this._loadingImg=new Hash},getLoadingIndicator:function(e){const n=this;let t="ajax-loader-32px";return"boolean"==typeof e?e&&(t="ajax-loader-16px"):"number"==typeof e&&(t="ajax-loader-"+e+"px"),n._loadingImg.get(t)||n._loadingImg.set(t,new Element("img",{src:CELEMENTS.getUtils().getPathPrefix()+"/file/resources/celRes/spinner/"+t+".png",class:"editorLoading",alt:"loading..."})),n._loadingImg.get(t).clone()}})),void 0===e.CELEMENTS.Utils){e.CELEMENTS.Utils=Class.create({_srcOriginHost:void 0,getPathPrefix:function(){const e=this;if(!e._srcOriginHost){let n=null;const t=document.getElementsByTagName("script");let i=t.length;const o=new RegExp("(https?://[^/]*)/(([^/]*/)*)resources/celJS/initCelements(.min)?\\.js(\\?.*)?$");let c;for(;i--;){c=t[i].src;const e=c.match(o);if(c&&e){n=e[1];const t=e[2].split("/"),i=t.splice(0,t.length-2).join("/");""!=i&&(n+="/"+i);break}}console.log("getPathPrefix computed prefixPath: ",n),e._srcOriginHost=n}return e._srcOriginHost},convertFullNameToViewURL:function(e){return this.getPathPrefix()+("/"+e.replace(/\./,"/")).replace(/\/Content\//,"/")}});const n=new e.CELEMENTS.Utils;e.CELEMENTS.getUtils=function(){return n}}void 0===e.CELEMENTS.getPathPrefix&&(e.CELEMENTS.getPathPrefix=function(){return console.warn("deprecated call of window.CELEMENTS.getPathPrefix. Instead use window.CELEMENTS.getUtils().getPathPrefix()"),e.CELEMENTS.getUtils().getPathPrefix()}),void 0===e.getCelHost&&(e.getCelHost=function(){let e=document.location+"?";return e=document.location.pathname.indexOf("/skin/resources/")>-1?e.substring(0,e.indexOf("/skin/resources/")):document.location.pathname.indexOf("/file/resources/")>-1?e.substring(0,e.indexOf("/file/resources/")):e.substring(0,e.indexOf("?")),e}),void 0===e.CELEMENTS.Ajax&&(e.CELEMENTS.Ajax={}),void 0===e.CELEMENTS.Ajax.Reconnector&&(e.CELEMENTS.Ajax.Reconnector=Class.create({_htmlElem:void 0,_callbackOnSuccess:void 0,_reconnectWait:void 0,_reconnectorHandlerBind:void 0,_cancelAjaxOnTimeoutBind:void 0,_reconnectorExecuter:void 0,_reconnectWaitStart:void 0,_minReconnectWait:void 0,_maxReconnectWait:void 0,_url:void 0,_configObj:void 0,initialize:function(n,t,i){const o=this;o._htmlElem=$(n),o._configObj=i||{},o._url=o._configObj.url||e.getCelHost(),o._callbackOnSuccess=t,o._reconnectorHandlerBind=o._reconnectorHandler.bind(o),o._cancelAjaxOnTimeoutBind=o._cancelAjaxOnTimeout.bind(o),o._minReconnectWait=o._configObj.minReconnectWait||10,o._maxReconnectWait=o._configObj.maxReconnectWait||30,o._reset()},_reset:function(){this._reconnectWaitStart=this._minReconnectWait},setMinRecconectWait:function(e){this._minReconnectWait=e},setMaxRecconectWait:function(e){this._maxReconnectWait=e},_fireAjaxRecconectTrying:function(){return this._htmlElem.fire("celements:AjaxReconnectTrying",this._reconnectWait)},_reconnectorHandler:function(){const n=this;if(n._reconnectWait--,0==n._reconnectWait){if(n._reconnectorExecuter.stop(),!n._fireAjaxRecconectTrying().stopped&&!n._configObj.skipRetryMsg){let t="Trying...";e.celMessages&&e.celMessages.Reconnector&&(t=e.celMessages.Reconnector.retryNotice),n._htmlElem.update(t)}n._connectionTester()}else if(!n._fireAjaxRecconectTrying().stopped&&!n._configObj.skipRetryMsg){let t="Retrying in {} seconds.";e.celMessages&&e.celMessages.Reconnector&&(t=e.celMessages.Reconnector.retryDelayNotice),t=t.replace("{}",n._reconnectWait),n._htmlElem.update(t),n._htmlElem.fire("celements:AjaxReconnectFailed")}},start:function(){this._reconnectWait=this._reconnectWaitStart,this._reconnectorExecuter=new PeriodicalExecuter(this._reconnectorHandlerBind,1)},_cancelAjaxOnTimeout:function(e){e._complete||e.transport.abort()},_connectionTester:function(){const e=this,n=new Ajax.Request(e._url,{parameters:{ajax:1,xpage:"celements_ajax",ajax_mode:"pageTypeWithLayout",overwriteLayout:"SimpleLayout"},onSuccess:function(){e._reset(),e._reconnectorExecuter=null,e._callbackOnSuccess(),e._htmlElem.fire("celements:AjaxReconnectSuccess")},onFailure:function(){e._reconnectWaitStart=Math.min(2*e._reconnectWaitStart,e._maxReconnectWait),e.start()}});e._cancelAjaxOnTimeoutBind.delay(10,n)}})),e.CELEMENTS.UrlUtils=Class.create({getParams:function(n){const t=(n=n||e.location.search).split(new RegExp("[?&]"));return t.unshift(new Hash),t.reduce(this._splitUriSearch.bind(this))||new Hash},joinParams:function(e){let n=[];return $H(e).each((function(e){const t=e.value.map((function(n){return e.key+"="+encodeURI(n)}));n=n.concat(t)})),n.join("&")},_splitUriSearch:function(e,n){let t=n.split("=",1);if(t.length>0&&t[0].length>0){t=t[0];const i=decodeURI(n.substring(t.length+1));e.get(t)?e.get(t).push(i):e.set(t,[i])}return e}}),e.celMessages={},e.celMessages.isLoaded=!1;try{new Ajax.Request(e.getCelHost(),{method:"post",parameters:{xpage:"celements_ajax",ajax_mode:"Messages"},onSuccess:function(n){if(n.responseText.isJSON()){const t=n.responseText.evalJSON();console.log("initCelements.js: finished getting dictionary messages."),t.isLoaded=!0,e.celMessages=t,$(document.body).fire("cel:messagesLoaded",t)}else console.error("noJSON!!! ",n.responseText)}})}catch(e){console.error("Failed to get Cel-Messages async!",e)}e.celExecOnceAfterMessagesLoaded=function(n){e.celMessages.isLoaded?n(e.celMessages):($(document.body).stopObserving("cel:messagesLoaded",n),$(document.body).observe("cel:messagesLoaded",n))},void 0===e.CELEMENTS.CssClassEventHandler&&(e.CELEMENTS.CssClassEventHandler=Class.create({_htmlElement:void 0,_eventName:void 0,_cssSelector:void 0,_className:void 0,_actionFunction:void 0,_conditionFunction:void 0,_actionHandlerBind:void 0,initialize:function(e,n,t,i,o,c){const s=this;s._htmlElement=$(e),s._eventName=n,s._cssSelector=t,s._className=i,s._actionFunction=o,c&&!/\s|;/.test(c)&&(s._conditionFunction=new Function("me","origin","return "+c+";")),s._actionHandlerBind=s._actionHandler.bind(s),s._registerActionHandler()},_registerActionHandler:function(){const e=this;Event.stopObserving(e._htmlElement,e._eventName,e._actionHandlerBind),Event.observe(e._htmlElement,e._eventName,e._actionHandlerBind),console.debug("EventHandler - register: ",e._eventName,e._cssSelector,e._className,e._actionFunction.name,e._htmlElement)},_actionHandler:function(e){const n=this;n._getTargetElements().each((function(e){!n._conditionFunction||n._conditionFunction(e,n._htmlElement)?(n._actionFunction(e,n._className),console.debug("EventHandler -  upon",n._eventName,"action [",n._actionFunction.name,n._className,"] executed on",e)):console.debug("EventHandler - action skipped for failed condition [",n._conditionFunction,"] on ",e)}))},_getTargetElements:function(){const e=this;return e._cssSelector.startsWith("^")?(parent=e._htmlElement.up(e._cssSelector.substring(1)),parent?[parent]:[]):$$(e._cssSelector)},unregister:function(){Event.stopObserving(this._htmlElement,this._eventName,this._actionHandlerBind),console.debug("EventHandler - unregister: ",this._eventName,this._cssSelector,this._className,this._actionFunction.name,this._htmlElement)}})),void 0===e.CELEMENTS.EventManager&&(e.CELEMENTS.EventManager=Class.create({_instructionRegex:new RegExp("([\\w:]+)([%+-])([\\w-]+):([^?]+)\\??(.+)?"),_actionFunctionMap:{"+":Element.addClassName,"-":Element.removeClassName,"%":Element.toggleClassName},_eventElements:void 0,_interpretDataCelEventBind:void 0,_contentChangedHandlerBind:void 0,updateCelEventHandlersBind:void 0,_intersectionObserver:void 0,_intersectionValues:[],initialize:function(){const e=this;e._eventElements=new Array,e._interpretDataCelEventBind=e._interpretDataCelEvent.bind(e),e._contentChangedHandlerBind=e._contentChangedHandler.bind(e),e.updateCelEventHandlersBind=e.updateCelEventHandlers.bind(e),e._intersectionObserver=new IntersectionObserver((function(n){n.forEach(e._handleIntersection.bind(e))}),{threshold:[0,.5,1]})},_splitDataCelEventList:function(e){let n=new Array;return e&&(n=e.replace(/([^&])&([^&])/g,"$1#SPLIT#$2").split("#SPLIT#")),n},_parseEventInstruction:function(e){const n=e.match(this._instructionRegex)||[],t={eventName:n[1],action:n[2],className:n[3],cssSelector:n[4],condition:n[5]};if(t.eventName&&t.action&&t.className&&t.cssSelector)return t;throw"parseEventInstruction: unable to parse event instruction '"+e+"'"},_createEventHandler:function(n,t){const i=this,o=i._parseEventInstruction(t),c=i._actionFunctionMap[o.action];if(c)return(o.eventName.startsWith("cel:enter")||o.eventName.startsWith("cel:leave"))&&(i._intersectionObserver.observe(n),console.debug("observing intersection: ",n)),new e.CELEMENTS.CssClassEventHandler(n,o.eventName,o.cssSelector,o.className,c,o.condition);throw"createEventHandler: unknown action '"+o.action+'"'},_createEventElement:function(e){const n=this,t=e.readAttribute("data-cel-event");return{htmlElem:e,dataValue:t,eventHandlers:n._splitDataCelEventList(t).map((function(t){try{return n._createEventHandler(e,t)}catch(n){console.error("EventManager - interpretData: invalid instruction ",n,e)}})).filter(Boolean)}},_interpretDataCelEvent:function(e){const n=this,t="EventManager - interpretData: ";if(e.hasClassName("celOnEventInit"))console.debug(t,"skip already initialized: ",e);else if(e.up(".cel_template"))console.debug(t,"skip template element: ",e);else{const i=n._createEventElement(e);i.eventHandlers.length>0?(n._eventElements.push(i),console.debug(t,"new element ",e)):console.debug(t,"no valid instructions found on ",e),e.addClassName("celOnEventInit"),e.fire("celEM:init")}},_handleIntersection:function(e,n){const t=this._intersectionValues[n]||{y:0,ratio:0},i={y:e.boundingClientRect.y,ratio:e.intersectionRatio},o=e.isIntersecting&&i.ratio>t.ratio?"enter":"leave",c=i.y>t.y?"up":"down";let s=e.intersectionRatio;s="enter"===o?s>=1?":full":s>.5?":half":"":s>.5?":full":s>0?":half":"";let a="cel:"+o+s;console.debug("fire",a),e.target.fire(a),a+=":"+c,console.debug("fire",a),e.target.fire(a),this._intersectionValues[n]=i},_contentChangedHandler:function(e){console.debug("EventManager - contentChanged ",e),this.updateCelEventHandlers(e.memo.htmlElem)},updateCelEventHandlers:function(e){e=e||$(document.body),Event.stopObserving($(document.body),"celements:contentChanged",this._contentChangedHandlerBind),Event.observe($(document.body),"celements:contentChanged",this._contentChangedHandlerBind),this._removeDisappearedElems(),$(e).select(".celOnEvent").each(this._interpretDataCelEventBind)},_removeDisappearedElems:function(){const e=this;for(let n=e._eventElements.length-1;n>=0;n--){const t=e._eventElements[n],i=$(document.body).contains(t.htmlElem),o=t.htmlElem.readAttribute("data-cel-event")!==t.dataValue;i&&!o&&t.htmlElem.hasClassName("celOnEventInit")||(t.eventHandlers.each((function(e){e.unregister()})),e._eventElements.splice(n,1),t.htmlElem.removeClassName("celOnEventInit"),console.debug("EventManager - removeDisappearedElem: ",t))}}}),e.CELEMENTS.globalEventManager=new e.CELEMENTS.EventManager,celAddOnBeforeLoadListener(e.CELEMENTS.globalEventManager.updateCelEventHandlersBind));const t=new Hash,i=function(e){if(e&&e.id){const n=new Validation(e,{immediate:!0,useTitles:!0,stopOnFirst:!1});t.set(e.id,n)}else console.error("failed to register validation on form with no id. ",e)};celAddOnBeforeLoadListener((function(){$$("form.cel_form_validation").each(i),$(document.body).observe("cel_yuiOverlay:contentChanged",(function(e){const n=e.findElement();n&&n.select("form.cel_form_validation").each(i)}))})),e.celAddOnFinishHeaderListener((function(){const n=$$('meta[name="cel-GAA-Num"]');if(n.size()>0&&""!=n[0].content){const l=n[0].content;t=e,i=document,o="script",c="ga",t.GoogleAnalyticsObject=c,t.ga=t.ga||function(){(t.ga.q=t.ga.q||[]).push(arguments)},t.ga.l=1*new Date,s=i.createElement(o),a=i.getElementsByTagName(o)[0],s.async=1,s.src="//www.google-analytics.com/analytics.js",a.parentNode.insertBefore(s,a),ga("create",l,e.getCelDomain()),ga("set","anonymizeIp",!0),ga("send","pageview"),console.log("finish initalizing google universal analytics.",l)}var t,i,o,c,s,a})),celAddOnBeforeLoadListener((function(){void 0!==$j("img[usemap]").rwdImageMaps&&$j("img[usemap]").rwdImageMaps()})),celAddOnBeforeLoadListener((function(){CELEMENTS&&CELEMENTS.presentation&&CELEMENTS.presentation.getOverlayObj&&CELEMENTS.presentation.getOverlayObj()&&CELEMENTS.presentation.getOverlayObj({overlayLayout:"SimpleLayout"}).registerOpenHandler()}));let o=null;const c=function(){o.getInnerWidth()>o.getInnerHeight()?($(document.body).removeClassName("cel_orientation_portrait"),$(document.body).addClassName("cel_orientation_landscape")):($(document.body).removeClassName("cel_orientation_landscape"),$(document.body).addClassName("cel_orientation_portrait"))};celAddOnBeforeLoadListener((function(){CELEMENTS&&CELEMENTS.mobile&&CELEMENTS.mobile.Dimensions&&(o=new CELEMENTS.mobile.Dimensions,Event.stopObserving(e,"orientationchange",c),Event.observe(e,"orientationchange",c))}));const s=function(e){console.debug("initAllMultiselect"),null!=$j().multiselect?$j(".celBootstrap,.celMultiselect").filter(":visible,.celForceMultiselect").each((function(e,n){$(n).up(".cel_template")||(console.debug("initAllMultiselect: ",n),a(n))})):console.debug("initAllMultiselect: bootstrap multiselect undefined")},a=function(e){let n={numberDisplayed:3,onDropdownHidden:l,onChange:r},t=e.getAttribute("data-bootstrapConfig");!t&&e.getAttribute("data-multiselectAttr")&&(t=e.getAttribute("data-multiselectAttr"),console.warn("initAllMultiselect: deprecated data-multiselectAttr in use",e)),t&&(n=$j.extend(n,JSON.parse(t)));const i=$j(e).multiselect(n);$(document.body).fire("cel:multiselectInitialized",{multiselect:i})},l=function(e){$j(e.target).css("display",""),e.target.fire("cel:multiselectOnDropdownHidden")},r=function(e,n,t){console.debug("fire cel:multiselectOnChange on: ",this),$(e[0]).fire("cel:multiselectOnChange",{multiselect:this,checked:n,select:t})},d=function(e){$("tabMenuPanel").select(".celBootstrap,.celMultiselect").each((function(e){e.visible()&&e.addClassName("celForceMultiselect")})),s()};celAddOnBeforeLoadListener((function(){$(document.body).stopObserving("cel:initMultiselect",s),$(document.body).stopObserving("celements:contentChanged",s),$(document.body).observe("cel:initMultiselect",s),$(document.body).observe("celements:contentChanged",s),$("tabMenuPanel")&&($("tabMenuPanel").stopObserving("tabedit:tabLoadingFinished",d),$("tabMenuPanel").observe("tabedit:tabLoadingFinished",d)),$(document.body).fire("cel:initMultiselect")}));const u=function(e){$$("img.cel_fluidresizeWidth").each((function(e){e.setStyle({maxWidth:e.readAttribute("width")+"px"})})),$$("img.cel_fluidresizeHeight").each((function(e){e.setStyle({maxHeight:e.readAttribute("height")+"px"})}))};celAddOnBeforeLoadListener((function(){$(document.body).stopObserving("cel:initFluidImage",u),$(document.body).stopObserving("celements:contentChanged",u),$(document.body).observe("cel:initFluidImage",u),$(document.body).observe("celements:contentChanged",u)})),celAddOnBeforeLoadListener((function(){$$(".generalOverlayWrapper .generalOverlay .exitOnClose").each((function(e){e.stopObserving("click",m),e.observe("click",m)}))}));const m=function(n){n.stop(),e.close()}}(window)