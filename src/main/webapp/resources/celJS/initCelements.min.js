!function(e,t){"use strict";void 0===e.console&&(e.console={}),void 0===e.console.error&&(e.console.error=Prototype.emptyFunction),void 0===e.console.warn&&(e.console.warn=e.console.error),void 0===e.console.info&&(e.console.info=e.console.warn),void 0===e.console.log&&(e.console.log=e.console.info),void 0===e.console.debug&&(e.console.debug=e.console.log),void 0===e.CELEMENTS&&(e.CELEMENTS={}),void 0===e.CELEMENTS.mixins&&(e.CELEMENTS.mixins={}),void 0===e.CELEMENTS.mixins.Event&&(e.CELEMENTS.mixins.Event=Class.create({memo:void 0,stopped:void 0,eventName:void 0,initialize:function(e,t){this.memo=t,this.eventName=e,this.stopped=!1},stop:function(){this.stopped=!0},findElement:function(){}})),void 0===e.CELEMENTS.mixins.Observable&&(e.CELEMENTS.mixins.Observable={_celEventHash:null,_getCelEventHash:function(e){const t=this;return t._celEventHash||(t._celEventHash=new Hash),e?(t._celEventHash.get(e)||t._celEventHash.set(e,new Array),t._celEventHash.get(e)):t._celEventHash},celObserve:function(e,t){if(console.debug("cel celObserve: ",this._celEventHash,e,t),!e)throw"undefined eventKey in observe call ";this._getCelEventHash(e).push(t)},celStopObserving:function(e,t){if(console.debug("cel celStopObserving: ",this._celEventHash,e,t),!e)throw"undefined eventKey in celStopObserving call ";this._getCelEventHash().set(e,this._getCelEventHash(e).without(t))},celFire:function(e,t){if(console.debug("cel celFire: ",this._celEventHash,e,t),!e)throw"undefined eventKey in celObserve call ";const n=new CELEMENTS.mixins.Event(e,t);return this._getCelEventHash(e).each(function(t){try{t(n)}catch(n){console.error("listener in celFire failed for event ",e,t,n)}}),n}});let n=[];e.celAddOnBeforeLoadListener=function(e){console.warn('celAddOnBeforeLoad is deprecated since open-celements 5.4 / January 2022. Instead register a listener on "DOMContentLoaded"',e),n.push(e)},document.addEventListener("DOMContentLoaded",function(){n.forEach(function(e){try{e()}catch(e){console.error("Listener for celOnBeforeLoad failed: ",e)}}),$(document.body).fire("celements:beforeOnLoad")});let o=[];if(e.celAddOnFinishHeaderListener=function(e){o.push(e)},e.celFinishHeaderHandler=function(){o.forEach(function(e){try{e()}catch(e){console.error("Failed to execute celOnFinishHeader listener. ",e)}})},void 0===e.getCelDomain&&(e.getCelDomain=function(){return e.location.host.replace(/^www\./,"")}),void 0===e.CELEMENTS.LoadingIndicator&&(e.CELEMENTS.LoadingIndicator=Class.create({_loadingImg:void 0,initialize:function(){this._loadingImg=new Hash},getLoadingIndicator:function(e){const t=this;let n="ajax-loader-32px";return"boolean"==typeof e?e&&(n="ajax-loader-16px"):"number"==typeof e&&(n="ajax-loader-"+e+"px"),t._loadingImg.get(n)||t._loadingImg.set(n,new Element("img",{src:CELEMENTS.getUtils().getPathPrefix()+"/file/resources/celRes/spinner/"+n+".png",class:"editorLoading",alt:"loading..."})),t._loadingImg.get(n).clone()}})),void 0===e.CELEMENTS.Utils){e.CELEMENTS.Utils=Class.create({_srcOriginHost:void 0,getPathPrefix:function(){const e=this;if(!e._srcOriginHost){let t=null;const n=document.getElementsByTagName("script");let o=n.length;const i=new RegExp("(https?://[^/]*)/(([^/]*/)*)resources/celJS/initCelements(.min)?\\.js(\\?.*)?$");let c;for(;o--;){const e=(c=n[o].src).match(i);if(c&&e){t=e[1];const n=e[2].split("/"),o=n.splice(0,n.length-2).join("/");""!=o&&(t+="/"+o);break}}console.log("getPathPrefix computed prefixPath: ",t),e._srcOriginHost=t}return e._srcOriginHost},convertFullNameToViewURL:function(e){return this.getPathPrefix()+("/"+e.replace(/\./,"/")).replace(/\/Content\//,"/")}});const t=new e.CELEMENTS.Utils;e.CELEMENTS.getUtils=function(){return t}}void 0===e.CELEMENTS.getPathPrefix&&(e.CELEMENTS.getPathPrefix=function(){return console.warn("deprecated call of window.CELEMENTS.getPathPrefix. Instead use window.CELEMENTS.getUtils().getPathPrefix()"),e.CELEMENTS.getUtils().getPathPrefix()}),void 0===e.getCelHost&&(e.getCelHost=function(){let e=document.location+"?";return e=document.location.pathname.indexOf("/skin/resources/")>-1?e.substring(0,e.indexOf("/skin/resources/")):document.location.pathname.indexOf("/file/resources/")>-1?e.substring(0,e.indexOf("/file/resources/")):e.substring(0,e.indexOf("?"))}),void 0===e.CELEMENTS.Ajax&&(e.CELEMENTS.Ajax={}),void 0===e.CELEMENTS.Ajax.Reconnector&&(e.CELEMENTS.Ajax.Reconnector=Class.create({_htmlElem:void 0,_callbackOnSuccess:void 0,_reconnectWait:void 0,_reconnectorHandlerBind:void 0,_cancelAjaxOnTimeoutBind:void 0,_reconnectorExecuter:void 0,_reconnectWaitStart:void 0,_minReconnectWait:void 0,_maxReconnectWait:void 0,_url:void 0,_configObj:void 0,initialize:function(t,n,o){const i=this;i._htmlElem=$(t),i._configObj=o||{},i._url=i._configObj.url||e.getCelHost(),i._callbackOnSuccess=n,i._reconnectorHandlerBind=i._reconnectorHandler.bind(i),i._cancelAjaxOnTimeoutBind=i._cancelAjaxOnTimeout.bind(i),i._minReconnectWait=i._configObj.minReconnectWait||10,i._maxReconnectWait=i._configObj.maxReconnectWait||30,i._reset()},_reset:function(){this._reconnectWaitStart=this._minReconnectWait},setMinRecconectWait:function(e){this._minReconnectWait=e},setMaxRecconectWait:function(e){this._maxReconnectWait=e},_fireAjaxRecconectTrying:function(){return this._htmlElem.fire("celements:AjaxReconnectTrying",this._reconnectWait)},_reconnectorHandler:function(){const t=this;if(t._reconnectWait--,0==t._reconnectWait){if(t._reconnectorExecuter.stop(),!t._fireAjaxRecconectTrying().stopped&&!t._configObj.skipRetryMsg){let n="Trying...";e.celMessages&&e.celMessages.Reconnector&&(n=e.celMessages.Reconnector.retryNotice),t._htmlElem.update(n)}t._connectionTester()}else if(!t._fireAjaxRecconectTrying().stopped&&!t._configObj.skipRetryMsg){let n="Retrying in {} seconds.";e.celMessages&&e.celMessages.Reconnector&&(n=e.celMessages.Reconnector.retryDelayNotice),n=n.replace("{}",t._reconnectWait),t._htmlElem.update(n),t._htmlElem.fire("celements:AjaxReconnectFailed")}},start:function(){this._reconnectWait=this._reconnectWaitStart,this._reconnectorExecuter=new PeriodicalExecuter(this._reconnectorHandlerBind,1)},_cancelAjaxOnTimeout:function(e){e._complete||e.transport.abort()},_connectionTester:function(){const e=this,t=new Ajax.Request(e._url,{parameters:{ajax:1,xpage:"celements_ajax",ajax_mode:"pageTypeWithLayout",overwriteLayout:"SimpleLayout"},onSuccess:function(){e._reset(),e._reconnectorExecuter=null,e._callbackOnSuccess(),e._htmlElem.fire("celements:AjaxReconnectSuccess")},onFailure:function(){e._reconnectWaitStart=Math.min(2*e._reconnectWaitStart,e._maxReconnectWait),e.start()}});e._cancelAjaxOnTimeoutBind.delay(10,t)}})),e.CELEMENTS.UrlUtils=Class.create({getParams:function(t){const n=(t=t||e.location.search).split(new RegExp("[?&]"));return n.unshift(new Hash),n.reduce(this._splitUriSearch.bind(this))||new Hash},joinParams:function(e){let t=[];return $H(e).each(function(e){const n=e.value.map(function(t){return e.key+"="+encodeURI(t)});t=t.concat(n)}),t.join("&")},_splitUriSearch:function(e,t){let n=t.split("=",1);if(n.length>0&&n[0].length>0){n=n[0];const o=decodeURI(t.substring(n.length+1));e.get(n)?e.get(n).push(o):e.set(n,[o])}return e}}),e.celMessages={},e.celMessages.isLoaded=!1;try{new Ajax.Request(e.getCelHost(),{method:"post",parameters:{xpage:"celements_ajax",ajax_mode:"Messages"},onSuccess:function(t){if(t.responseText.isJSON()){const n=t.responseText.evalJSON();console.log("initCelements.js: finished getting dictionary messages."),n.isLoaded=!0,e.celMessages=n,$(document.body).fire("cel:messagesLoaded",n)}else console.error("noJSON!!! ",t.responseText)}})}catch(e){console.error("Failed to get Cel-Messages async!",e)}const i=[];e.celExecOnceAfterMessagesLoaded=function(t){i.includes(t)||(i.push(t),e.celMessages.isLoaded?t(e.celMessages):$(document.body).observe("cel:messagesLoaded",e=>t(e.memo)))},void 0===e.CELEMENTS.CssClassEventHandler&&(e.CELEMENTS.CssClassEventHandler=Class.create({_htmlElement:void 0,_eventName:void 0,_cssSelector:void 0,_className:void 0,_actionFunction:void 0,_conditionFunction:void 0,_actionHandlerBind:void 0,initialize:function(e,t,n,o,i,c){const s=this;s._htmlElement=$(e),s._eventName=t,s._cssSelector=n,s._className=o,s._actionFunction=i,c&&!/\s|;/.test(c)&&(s._conditionFunction=new Function("me","origin","return "+c+";")),s._actionHandlerBind=s._actionHandler.bind(s),s._registerActionHandler()},_registerActionHandler:function(){const e=this;Event.stopObserving(e._htmlElement,e._eventName,e._actionHandlerBind),Event.observe(e._htmlElement,e._eventName,e._actionHandlerBind),console.debug("EventHandler - register: ",e._eventName,e._cssSelector,e._className,e._actionFunction.name,e._htmlElement)},_actionHandler:function(e){const t=this;t._getTargetElements().each(function(e){!t._conditionFunction||t._conditionFunction(e,t._htmlElement)?(t._actionFunction(e,t._className),console.debug("EventHandler -  upon",t._eventName,"action [",t._actionFunction.name,t._className,"] executed on",e)):console.debug("EventHandler - action skipped for failed condition [",t._conditionFunction,"] on ",e)})},_getTargetElements:function(){const e=this;return e._cssSelector.startsWith("^")?(parent=e._htmlElement.up(e._cssSelector.substring(1)),parent?[parent]:[]):$$(e._cssSelector)},unregister:function(){Event.stopObserving(this._htmlElement,this._eventName,this._actionHandlerBind),console.debug("EventHandler - unregister: ",this._eventName,this._cssSelector,this._className,this._actionFunction.name,this._htmlElement)}})),void 0===e.CELEMENTS.EventManager&&(e.CELEMENTS.EventManager=Class.create({_instructionRegex:new RegExp(/([\w:]+)([%+-])([\w-]+):([^?]+)\??(.+)?/),_actionFunctionMap:{"+":Element.addClassName,"-":Element.removeClassName,"%":Element.toggleClassName},_eventElements:void 0,_eventElemCounter:void 0,_interpretDataCelEventBind:void 0,_contentChangedHandlerBind:void 0,_intersectionObserver:void 0,_intersectionValues:[],initialize:function(){const e=this;e._eventElements=new Array,e._eventElemCounter=0,e._interpretDataCelEventBind=e._interpretDataCelEvent.bind(e),e._contentChangedHandlerBind=e._contentChangedHandler.bind(e);try{e._intersectionObserver=new IntersectionObserver(function(t){t.forEach(e._handleIntersection.bind(e))},{threshold:[0,.5,1]})}catch(e){console.warn("EventManager - initialize: IntersectionObserver not available",e)}},_splitDataCelEventList:function(e){let t=new Array;return e&&(t=e.replace(/([^&])&([^&])/g,"$1#SPLIT#$2").split("#SPLIT#")),t},_parseEventInstruction:function(e){const t=e.match(this._instructionRegex)||[],n={eventName:t[1],action:t[2],className:t[3],cssSelector:t[4],condition:t[5]};if(n.eventName&&n.action&&n.className&&n.cssSelector)return n;throw"parseEventInstruction: unable to parse event instruction '"+e+"'"},_createEventHandler:function(t,n){const o=this,i=o._parseEventInstruction(n),c=o._actionFunctionMap[i.action];if(c)return o._intersectionObserver&&(i.eventName.startsWith("cel:enter")||i.eventName.startsWith("cel:leave"))&&(o._intersectionObserver.observe(t),console.debug("EventManager - observing intersection",t.dataset.celEventNb,i)),new e.CELEMENTS.CssClassEventHandler(t,i.eventName,i.cssSelector,i.className,c,i.condition);throw"createEventHandler: unknown action '"+i.action+'"'},_createEventElement:function(e){const t=this,n=e.dataset.celEvent;return{htmlElem:e,dataValue:n,eventHandlers:t._splitDataCelEventList(n).map(function(n){try{return t._createEventHandler(e,n)}catch(t){console.error("EventManager - interpretData: invalid instruction ",t,e)}}).filter(Boolean)}},_interpretDataCelEvent:function(e){const t=this,n="EventManager - interpretData: ";if(e.classList.contains("celOnEventInit"))console.debug(n,"skip already initialized: ",e);else if(e.up(".cel_template"))console.debug(n,"skip template element: ",e);else{e.dataset.celEventNb=++t._eventElemCounter;const o=t._createEventElement(e);o.eventHandlers.length>0?t._eventElements.push(o):console.warn(n,"no valid instructions found on ",e),e.classList.add("celOnEventInit"),$(e).fire("celEM:init")}},_handleIntersection:function(e){const t=e.target,n=t.dataset.celEventNb,o=this._intersectionValues[n]||Object.freeze({y:Number.MAX_SAFE_INTEGER,ratio:0}),i=Object.freeze({y:e.boundingClientRect.y,ratio:e.intersectionRatio}),c=i.y>o.y?"up":"down",s=e.isIntersecting&&i.ratio>=o.ratio?"enter":"leave",a="enter"===s?i.ratio:o.ratio,l="leave"===s?i.ratio:o.ratio,r=[];a>=1&&l<1&&r.push(":full"),a>=.5&&l<.5&&r.push(":half"),a>0&&l<=0&&r.push(""),r.forEach(function(e){["cel:"+s+e,"cel:"+s+e+":"+c].forEach(function(e){console.debug("EventManager - intersect",e,"on",n,o,"->",i),t.fire(e)})}),this._intersectionValues[n]=i},_contentChangedHandler:function(e){const t=this;console.debug("EventManager - contentChanged ",e),e.memo&&e.memo.htmlElem?t.updateCelEventHandlers(e.memo.htmlElem):t.updateCelEventHandlers()},updateCelEventHandlers:function(e){const t=e||document.body;Event.stopObserving($(document.body),"celements:contentChanged",this._contentChangedHandlerBind),Event.observe($(document.body),"celements:contentChanged",this._contentChangedHandlerBind),this._removeDisappearedElems(),t.querySelectorAll(".celOnEvent").forEach(this._interpretDataCelEventBind)},_removeDisappearedElems:function(){const e=this;for(let t=e._eventElements.length-1;t>=0;t--){const n=e._eventElements[t],o=$(document.body).contains(n.htmlElem),i=n.htmlElem.dataset.celEvent!==n.dataValue;o&&!i&&n.htmlElem.classList.contains("celOnEventInit")||(n.eventHandlers.forEach(function(e){e.unregister()}),e._eventElements.splice(t,1),n.htmlElem.classList.remove("celOnEventInit"),console.debug("EventManager - removeDisappearedElem: ",n))}}}),e.CELEMENTS.globalEventManager=new e.CELEMENTS.EventManager,document.addEventListener("DOMContentLoaded",e.CELEMENTS.globalEventManager._contentChangedHandlerBind));const c=new Hash,s=function(e){if(e&&e.id){const t=new Validation(e,{immediate:!0,useTitles:!0,stopOnFirst:!1});c.set(e.id,t)}else console.error("failed to register validation on form with no id. ",e)};document.addEventListener("DOMContentLoaded",function(){$$("form.cel_form_validation").each(s),$(document.body).observe("cel_yuiOverlay:contentChanged",function(e){const t=e.findElement();t&&t.select("form.cel_form_validation").each(s)})}),e.celAddOnFinishHeaderListener(function(){const t=$$('meta[name="cel-GAA-Num"]');if(t.size()>0&&""!=t[0].content){const r=t[0].content;if(r.startsWith("UA-"))o=e,i=document,c="script",s="ga",o.GoogleAnalyticsObject=s,o.ga=o.ga||function(){(o.ga.q=o.ga.q||[]).push(arguments)},o.ga.l=1*new Date,a=i.createElement(c),l=i.getElementsByTagName(c)[0],a.async=1,a.src="//www.google-analytics.com/analytics.js",l.parentNode.insertBefore(a,l),ga("create",r,e.getCelDomain()),ga("set","anonymizeIp",!0),ga("send","pageview"),console.log("finish initalizing google universal analytics.",r);else{function n(){dataLayer.push(arguments)}!function(e,t,n,o,i){o=e.createElement(o),i=e.getElementsByTagName("script")[0],o.async=1,o.src=n,i.parentNode.insertBefore(o,i)}(document,0,"https://www.googletagmanager.com/gtag/js?id="+r),e.dataLayer=e.dataLayer||[],n("js",new Date),n("config",r),console.log("finish initalizing google analytics v4.",r)}}var o,i,c,s,a,l}),document.addEventListener("DOMContentLoaded",function(){void 0!==$j("img[usemap]").rwdImageMaps&&$j("img[usemap]").rwdImageMaps()}),document.addEventListener("DOMContentLoaded",function(){CELEMENTS&&CELEMENTS.presentation&&CELEMENTS.presentation.getOverlayObj&&CELEMENTS.presentation.getOverlayObj()&&CELEMENTS.presentation.getOverlayObj({overlayLayout:"SimpleLayout"}).registerOpenHandler()});let a=null;const l=function(){a.getInnerWidth()>a.getInnerHeight()?($(document.body).removeClassName("cel_orientation_portrait"),$(document.body).addClassName("cel_orientation_landscape")):($(document.body).removeClassName("cel_orientation_landscape"),$(document.body).addClassName("cel_orientation_portrait"))};document.addEventListener("DOMContentLoaded",function(){CELEMENTS&&CELEMENTS.mobile&&CELEMENTS.mobile.Dimensions&&(a=new CELEMENTS.mobile.Dimensions,Event.stopObserving(e,"orientationchange",l),Event.observe(e,"orientationchange",l))});const r=function(e){console.debug("initAllMultiselect"),null!=$j().multiselect?$j(".celBootstrap,.celMultiselect").filter(":visible,.celForceMultiselect").each(function(e,t){$(t).up(".cel_template")||(console.debug("initAllMultiselect: ",t),d(t))}):console.debug("initAllMultiselect: bootstrap multiselect undefined")},d=function(e){let t={numberDisplayed:3,onDropdownHidden:u,onChange:m},n=e.getAttribute("data-bootstrapConfig");!n&&e.getAttribute("data-multiselectAttr")&&(n=e.getAttribute("data-multiselectAttr"),console.warn("initAllMultiselect: deprecated data-multiselectAttr in use",e)),n&&(t=$j.extend(t,JSON.parse(n)));const o=$j(e).multiselect(t);$(document.body).fire("cel:multiselectInitialized",{multiselect:o})},u=function(e){$j(e.target).css("display",""),e.target.fire("cel:multiselectOnDropdownHidden")},m=function(e,t,n){console.debug("fire cel:multiselectOnChange on: ",this),$(e[0]).fire("cel:multiselectOnChange",{multiselect:this,checked:t,select:n})},E=function(e){$("tabMenuPanel").select(".celBootstrap,.celMultiselect").each(function(e){e.visible()&&e.addClassName("celForceMultiselect")}),r()};document.addEventListener("DOMContentLoaded",function(){$(document.body).stopObserving("cel:initMultiselect",r),$(document.body).stopObserving("celements:contentChanged",r),$(document.body).observe("cel:initMultiselect",r),$(document.body).observe("celements:contentChanged",r),$("tabMenuPanel")&&($("tabMenuPanel").stopObserving("tabedit:tabLoadingFinished",E),$("tabMenuPanel").observe("tabedit:tabLoadingFinished",E)),$(document.body).fire("cel:initMultiselect")});const g=function(e){$$("img.cel_fluidresizeWidth").each(function(e){e.setStyle({maxWidth:e.readAttribute("width")+"px"})}),$$("img.cel_fluidresizeHeight").each(function(e){e.setStyle({maxHeight:e.readAttribute("height")+"px"})})};document.addEventListener("DOMContentLoaded",function(){$(document.body).stopObserving("cel:initFluidImage",g),$(document.body).stopObserving("celements:contentChanged",g),$(document.body).observe("cel:initFluidImage",g),$(document.body).observe("celements:contentChanged",g)}),document.addEventListener("DOMContentLoaded",function(){$$(".generalOverlayWrapper .generalOverlay .exitOnClose").each(function(e){e.stopObserving("click",v),e.observe("click",v)})});const v=function(t){t.stop(),e.close()},h=function(){void 0!==$j.format&&$j.format.locale({date:celMessages.jqueryFormater})};document.addEventListener("DOMContentLoaded",function(){e.celMessages.isLoaded&&"object"==typeof celMessages.jqueryFormater?h():$(document.body).observe("cel:messagesLoaded",h)})}(window);